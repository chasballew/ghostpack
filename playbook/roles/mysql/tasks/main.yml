---
# file roles/mysql/tasks/main.yml

- name: Install Mysql
  apt: name=$item state=present update_cache=yes
  with_items:
  - mysql-client
  - mysql-server-5.5
  - python-mysqldb

- name: Copy MySQL configuration
  template: src=my.cnf.j2 dest=/etc/mysql/my.cnf
  notify:
    - restart mysql

- name: Start Mysql Service
  service: name=mysql state=started enabled=true

- name: Create Ghost dev database
  mysql_db: name=ghostdev state=present

- name: Create Ghost prod database
  mysql_db: name=ghost state=present

- name: Create Ghost MySQL user
  mysql_user: name={{ mysql_username }}
              password={{ mysql_password }}
              priv=*.*:ALL
              host='localhost'
              state=present
